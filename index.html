<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† Avalia√ß√£o Psiqui√°trica ¬∑ CAPS (ambulat√≥rio)</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background: #e2eef7;
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 1.5rem;
            color: #10344a;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 1.8rem;
        }
        h1 { font-size: 2.2rem; font-weight: 500; border-bottom: 4px solid #1e6f9c; padding-bottom: 0.4rem; color: #043a54; }
        h2 { font-size: 1.5rem; margin: 0.2rem 0 0.8rem; color: #105e83; border-left: 6px solid #3089c2; padding-left: 1rem; background: #f0f9ff; }
        .card {
            background: #ffffffd9;
            backdrop-filter: blur(3px);
            border-radius: 28px;
            padding: 1.5rem 2rem;
            box-shadow: 0 18px 30px -8px #1f4f6e80;
            border: 1px solid #a6cfed;
        }
        .flex-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: flex-end;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            min-width: 140px;
        }
        .input-group label, .field-label {
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            color: #195e83;
            margin-bottom: 0.2rem;
        }
        .input-group input, .input-group select, .input-group textarea {
            padding: 0.7rem 1rem;
            border: 1.5px solid #c3ddef;
            border-radius: 40px;
            font-size: 0.9rem;
            background: white;
            transition: 0.15s;
        }
        .input-group input:focus, .input-group select:focus, .input-group textarea:focus {
            border-color: #1a83c0;
            box-shadow: 0 0 0 4px #1783ca30;
            outline: none;
        }
        textarea { min-height: 65px; resize: vertical; border-radius: 24px !important; }
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 0.5rem 0 1rem;
        }
        .med-row {
            background: #ebf6fe;
            border-radius: 28px;
            padding: 1.2rem 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1.2rem;
            align-items: flex-end;
        }
        .mini-input {
            display: flex;
            flex-direction: column;
            min-width: 140px;
        }
        .btn {
            background: #1f77a3;
            border: none;
            color: white;
            font-weight: 600;
            padding: 0.8rem 2.2rem;
            border-radius: 60px;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 6px 12px #0e4b6e5e;
            transition: 0.15s;
            border: 1px solid #c3e2ff;
        }
        .btn:hover { background: #0c5c86; transform: scale(1.02); }
        .btn-copy { background: #286f55; float: right; }
        .meem-tbl {
            width: 100%;
            border-collapse: collapse;
            background: #f1fafd;
            border-radius: 24px;
            overflow: hidden;
        }
        .meem-tbl th { background: #b5d8f0; padding: 0.8rem; }
        .meem-tbl td { padding: 0.6rem 1rem; border-bottom: 1px solid #bed9f0; }
        .meem-tbl select { padding: 0.3rem 1rem; border-radius: 40px; border: 1px solid #6fa9d1; }
        .output-box {
            background: #0e2b36;
            color: #e0f3ff;
            padding: 1.8rem 2.2rem;
            border-radius: 32px;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            border: 2px solid #3483aa;
            max-height: 440px;
            overflow-y: auto;
        }
        .badge-imc {
            background: #c7e2fa;
            padding: 0.3rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>üß† EXAME PS√çQUICO ¬∑ CAPS (anamnese completa)</h1>

    <!-- ########## 1. IDENTIFICA√á√ÉO + QD + IMC autom√°tico ########## -->
    <div class="card">
        <h2>üìå 1. Identifica√ß√£o e queixa principal</h2>
        <div class="flex-row">
            <div class="input-group"><label>Sexo</label>
                <select id="sexo">
                    <option value="" selected disabled>‚Äî selecione ‚Äî</option>
                    <option value="feminino">Feminino</option>
                    <option value="masculino">Masculino</option>
                    <option value="outro">Outro</option>
                </select>
            </div>
            <div class="input-group"><label>Idade (anos)</label><input type="number" id="idade" value="" placeholder="ex: 38"></div>
            <div class="input-group"><label>Peso (kg)</label><input type="number" id="peso" step="0.1" placeholder="ex: 72.5"></div>
            <div class="input-group"><label>Altura (m)</label><input type="number" id="altura" step="0.01" placeholder="ex: 1.70"></div>
            <div class="input-group"><label>IMC (autom.)</label><input type="text" id="imc" readonly placeholder="--"></div>
            <div class="input-group"><label>Classif. IMC</label><input type="text" id="classIMC" readonly placeholder="--"></div>
        </div>
        <div style="margin-top: 1.2rem;">
            <label class="field-label">üìù Queixa principal (QD):</label>
            <textarea id="queixaPrincipal" placeholder="Ex.: 'escuto vozes', 'tristeza o tempo todo'..."></textarea>
        </div>
    </div>

    <!-- ########## 2. ANTECEDENTES ########## -->
    <div class="card">
        <h2>üìã 2. Antecedentes pessoais, familiares, comorbidades</h2>
        <div class="grid-2">
            <div><label class="field-label">Antecedentes pessoais (inf√¢ncia, desenvolvimento, traumas)</label>
                <textarea id="antePessoais" placeholder="ex.: nascimento normal, abuso na inf√¢ncia..."></textarea>
            </div>
            <div><label class="field-label">Antecedentes familiares (transtornos mentais, suic√≠dio)</label>
                <textarea id="anteFamiliares" placeholder="ex.: m√£e depress√£o, irm√£o alcoolista"></textarea>
            </div>
        </div>
        <div style="margin-top:0.8rem">
            <label class="field-label">üßæ Comorbidades cl√≠nicas (HAS, DM, epilepsia, etc.)</label>
            <textarea id="comorbidades" placeholder="ex.: hipertens√£o, hipotireoidismo"></textarea>
        </div>
    </div>

    <!-- ########## 3. MEDICA√á√ïES + TERAPIA ########## -->
    <div class="card">
        <h2>üíä 3. Medica√ß√µes em uso e psicoterapia</h2>
        <!-- medicamento 1 -->
        <div class="med-row">
            <div class="mini-input"><label>Nome (med 1)</label><input type="text" id="medNome1" placeholder="ex.: sertralina"></div>
            <div class="mini-input"><label>Dose</label><input type="text" id="medDose1" placeholder="50mg/dia"></div>
            <div class="mini-input"><label>Tempo uso</label><input type="text" id="medTempo1" placeholder="ex.: 3 meses"></div>
            <div class="mini-input"><label>Indica√ß√£o</label><input type="text" id="medInd1" placeholder="depress√£o"></div>
        </div>
        <!-- medicamento 2 -->
        <div class="med-row">
            <div class="mini-input"><label>Nome (med 2)</label><input type="text" id="medNome2" placeholder="ex.: losartana"></div>
            <div class="mini-input"><label>Dose</label><input type="text" id="medDose2" placeholder="50mg/dia"></div>
            <div class="mini-input"><label>Tempo uso</label><input type="text" id="medTempo2" placeholder="ex.: 1 ano"></div>
            <div class="mini-input"><label>Indica√ß√£o</label><input type="text" id="medInd2" placeholder="HAS"></div>
        </div>
        <!-- terapia -->
        <div style="margin-top:0.8rem;">
            <label class="field-label">üßò Acompanhamento psicoter√°pico:</label>
            <select id="terapiaSelect">
                <option value="" selected disabled>‚Äî selecione ‚Äî</option>
                <option value="n√£o faz terapia">n√£o faz terapia</option>
                <option value="psicoterapia semanal (psican√°lise)">psicoterapia semanal (psican√°lise)</option>
                <option value="psicoterapia TCC">TCC</option>
                <option value="grupo de apoio CAPS">grupo de apoio CAPS</option>
                <option value="outro">outro</option>
            </select>
        </div>
    </div>

    <!-- ########## 4. MEEM ‚Äì sem placeholders, tudo num√©rico fixo ########## -->
    <div class="card">
        <h2>üß© 4. Mini-Exame do Estado Mental (MEEM)  total: <span id="meemTotalDisplay">0</span>/30</h2>
        <table class="meem-tbl">
            <tr><th>Item</th><th>Pontua√ß√£o</th></tr>
            <tr><td>Orienta√ß√£o temporal (ano, esta√ß, dia, m√™s, dia m√™s) 0-5</td><td><select id="meem1" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select></td></tr>
            <tr><td>Orienta√ß√£o espacial (pa√≠s, estado, cidade, local, andar) 0-5</td><td><select id="meem2" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select></td></tr>
            <tr><td>Registro (pente, rua, azul) 0-3</td><td><select id="meem3" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option> </select></td></tr>
            <tr><td>Aten√ß√£o/c√°lculo (100-7 ou s√©rie) 0-5</td><td><select id="meem4" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option> </select></td></tr>
            <tr><td>Evoca√ß√£o (3 palavras) 0-3</td><td><select id="meem5" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option> </select></td></tr>
            <tr><td>Linguagem: nomear l√°pis/rel√≥gio 0-2</td><td><select id="meem6" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option> </select></td></tr>
            <tr><td>Repetir "nem aqui, nem ali, nem l√°" 0-1</td><td><select id="meem7" class="meem"> <option value="0">0</option><option value="1">1</option> </select></td></tr>
            <tr><td>Comando tr√™s est√°gios (pegar/dobrar/ch√£o) 0-3</td><td><select id="meem8" class="meem"> <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option> </select></td></tr>
            <tr><td>Ler e executar "FECHE OS OLHOS" 0-1</td><td><select id="meem9" class="meem"> <option value="0">0</option><option value="1">1</option> </select></td></tr>
            <tr><td>Escrever uma frase 0-1</td><td><select id="meem10" class="meem"> <option value="0">0</option><option value="1">1</option> </select></td></tr>
            <tr><td>Copiar desenho 0-1</td><td><select id="meem11" class="meem"> <option value="0">0</option><option value="1">1</option> </select></td></tr>
        </table>
    </div>

    <!-- ########## 5. EXAME PS√çQUICO (APEJUCOL) ########## -->
    <div class="card">
        <h2>üîé 5. Exame ps√≠quico detalhado</h2>
        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(260px,1fr)); gap: 1.2rem;">
            <div><label>Consci√™ncia</label> <select id="consciencia"><option value="" selected>--</option><option value="l√∫cido">l√∫cido</option><option value="obnubilado">obnubilado</option><option value="sonolento">sonolento</option><option value="torporoso">torporoso</option><option value="delirium">delirium</option></select></div>
            <div><label>Aten√ß√£o</label> <select id="atencao"><option value="" selected>--</option><option value="normoprosexia">normoprosexia</option><option value="hipoprosexia">hipoprosexia</option><option value="hiperprosexia">hiperprosexia</option><option value="distra√ß√£o">distra√ß√£o</option></select></div>
            <div><label>Orienta√ß√£o</label> <select id="orientacao"><option value="" selected>--</option><option value="orientado auto e alopsiquicamente">orientado</option><option value="desorientado temporal">desorientado temporal</option><option value="desorientado espacial">desorientado espacial</option></select></div>
            <div><label>Mem√≥ria</label> <select id="memoria"><option value="" selected>--</option><option value="preservada">preservada</option><option value="hipomn√©sia anter√≥grada">hipomn√©sia anter√≥grada</option><option value="amn√©sia retr√≥grada">amn√©sia retr√≥grada</option><option value="confabula√ß√£o">confabula√ß√£o</option></select></div>
            <div><label>Intelig√™ncia</label> <select id="inteligencia"><option value="" selected>--</option><option value="dentro da m√©dia">dentro da m√©dia</option><option value="inferior √† m√©dia">inferior</option><option value="deficit moderado">d√©ficit moderado</option></select></div>
            <div><label>Sensopercep√ß√£o</label> <select id="sensopercepcao"><option value="" selected>--</option><option value="sem altera√ß√µes">sem altera√ß√µes</option><option value="alucina√ß√£o auditiva">alucina√ß√£o auditiva</option><option value="alucina√ß√£o visual">alucina√ß√£o visual</option><option value="ilus√£o">ilus√£o</option></select></div>
            <div><label>Afeto/humor</label> <select id="afeto"><option value="" selected>--</option><option value="eut√≠mico">eut√≠mico</option><option value="depressivo">depressivo</option><option value="ansioso">ansioso</option><option value="euf√≥rico">euf√≥rico</option><option value="embotado">embotado</option></select></div>
            <div><label>Pensamento (curso)</label> <select id="pensamentoCurso"><option value="" selected>--</option><option value="regular">regular</option><option value="acelerado (taquipsiquismo)">acelerado</option><option value="lentificado">lentificado</option><option value="fuga de id√©ias">fuga de id√©ias</option></select></div>
            <div><label>Conte√∫do pensamento</label> <select id="conteudo"><option value="" selected>--</option><option value="sem del√≠rios">sem del√≠rios</option><option value="del√≠rio persecut√≥rio">persecut√≥rio</option><option value="del√≠rio de grandeza">grandeza</option><option value="idea√ß√£o suicida">idea√ß√£o suicida</option><option value="obsess√µes">obsess√µes</option></select></div>
            <div><label>Linguagem</label> <select id="linguagem"><option value="" selected>--</option><option value="fluente">fluente</option><option value="logorreia">logorreia</option><option value="mutismo">mutismo</option><option value="ecolalia">ecolalia</option></select></div>
            <div><label>Psicomotricidade</label> <select id="psicomotricidade"><option value="" selected>--</option><option value="normal">normal</option><option value="agitado">agitado</option><option value="lentificado">lentificado</option><option value="estereotipias">estereotipias</option></select></div>
            <div><label>Vontade</label> <select id="vontade"><option value="" selected>--</option><option value="normobulia">normobulia</option><option value="hipobulia">hipobulia</option><option value="abulia">abulia</option></select></div>
            <div><label>Ju√≠zo cr√≠tico</label> <select id="juizo"><option value="" selected>--</option><option value="preservado">preservado</option><option value="parcial">parcial</option><option value="prejudicado">prejudicado</option></select></div>
        </div>
    </div>

    <!-- ########## BOT√ïES E OUTPUT ########## -->
    <div style="display: flex; gap: 1.5rem; align-items: center; flex-wrap: wrap;">
        <button class="btn" id="gerarHDA">üìÑ GERAR HDA + CONDUTA</button>
        <button class="btn btn-copy" id="copiarTexto">üìã COPIAR EVOLU√á√ÉO</button>
    </div>
    <div class="output-box" id="outputFinal">
        Preencha os campos e clique em "GERAR HDA" para produzir o texto.
    </div>
    <div style="color: #1f5c7a; font-size: 0.85rem; border-top: 1px dashed #4f96c3; padding-top: 0.8rem;">
        ‚ö° IMC autom√°tico. Todos os campos iniciados em branco. MEEM sem placeholders.
    </div>
</div>

<script>
    (function() {
        // IMC autom√°tico com inputs vazios
        function updateIMC() {
            const peso = parseFloat(document.getElementById('peso').value);
            const altura = parseFloat(document.getElementById('altura').value);
            if (isNaN(peso) || isNaN(altura) || peso <= 0 || altura < 0.5) {
                document.getElementById('imc').value = '';
                document.getElementById('classIMC').value = '';
                return;
            }
            const imc = peso / (altura * altura);
            let classe = '';
            if (imc < 18.5) classe = 'Abaixo do peso';
            else if (imc < 25) classe = 'Peso normal';
            else if (imc < 30) classe = 'Sobrepeso';
            else if (imc < 35) classe = 'Obesidade I';
            else if (imc < 40) classe = 'Obesidade II';
            else classe = 'Obesidade III';
            document.getElementById('imc').value = imc.toFixed(1);
            document.getElementById('classIMC').value = classe;
        }
        document.getElementById('peso')?.addEventListener('input', updateIMC);
        document.getElementById('altura')?.addEventListener('input', updateIMC);

        // MEEM total
        const meemSelects = document.querySelectorAll('.meem');
        function calcMEEM() {
            let total = 0;
            meemSelects.forEach(sel => { total += parseInt(sel.value) || 0; });
            document.getElementById('meemTotalDisplay').innerText = total;
            return total;
        }
        meemSelects.forEach(s => s.addEventListener('change', calcMEEM));
        calcMEEM();

        // Gerar HDA e conduta
        document.getElementById('gerarHDA').addEventListener('click', function() {
            const sexo = document.getElementById('sexo').value || 'n√£o informado';
            const idade = document.getElementById('idade').value || '?';
            const imc = document.getElementById('imc').value || '--';
            const classeImc = document.getElementById('classIMC').value || '--';
            const qd = document.getElementById('queixaPrincipal').value.trim() || 'n√£o referida';
            const antePessoal = document.getElementById('antePessoais').value.trim() || 'sem informa√ß√£o';
            const anteFamiliar = document.getElementById('anteFamiliares').value.trim() || 'sem informa√ß√£o';
            const comorb = document.getElementById('comorbidades').value.trim() || 'nenhuma';
            const med1 = document.getElementById('medNome1').value.trim();
            const dose1 = document.getElementById('medDose1').value.trim();
            const tempo1 = document.getElementById('medTempo1').value.trim();
            const ind1 = document.getElementById('medInd1').value.trim();
            const med2 = document.getElementById('medNome2').value.trim();
            const dose2 = document.getElementById('medDose2').value.trim();
            const tempo2 = document.getElementById('medTempo2').value.trim();
            const ind2 = document.getElementById('medInd2').value.trim();
            let medText = '';
            if (med1) medText += `\n- ${med1} ${dose1} (${tempo1}) para ${ind1}`;
            if (med2) medText += `\n- ${med2} ${dose2} (${tempo2}) para ${ind2}`;
            if (!med1 && !med2) medText = ' nenhum medicamento referido.';
            const terapia = document.getElementById('terapiaSelect').value || 'n√£o informado';

            // fun√ß√µes (se vazio, coloca 'n√£o descrito')
            const consc = document.getElementById('consciencia').value || 'n√£o descrito';
            const atenc = document.getElementById('atencao').value || 'n√£o descrito';
            const orient = document.getElementById('orientacao').value || 'n√£o descrito';
            const mem = document.getElementById('memoria').value || 'n√£o descrito';
            const intel = document.getElementById('inteligencia').value || 'n√£o descrito';
            const sens = document.getElementById('sensopercepcao').value || 'n√£o descrito';
            const afet = document.getElementById('afeto').value || 'n√£o descrito';
            const pensCurso = document.getElementById('pensamentoCurso').value || 'n√£o descrito';
            const conteudoPens = document.getElementById('conteudo').value || 'n√£o descrito';
            const ling = document.getElementById('linguagem').value || 'n√£o descrito';
            const psicomot = document.getElementById('psicomotricidade').value || 'n√£o descrito';
            const vont = document.getElementById('vontade').value || 'n√£o descrito';
            const juizo = document.getElementById('juizo').value || 'n√£o descrito';
            const meemTotal = calcMEEM();

            // HDA texto
            let hda = `HIST√ìRIA DA DOEN√áA ATUAL (gerada)\n`;
            hda += `Paciente ${sexo}, ${idade} anos, IMC=${imc} (${classeImc}). QD: "${qd}".\n`;
            hda += `Antecedentes pessoais: ${antePessoal}. Familiares: ${anteFamiliar}.\nComorbidades: ${comorb}.\n`;
            hda += `Medicamentos: ${medText}\nPsicoterapia: ${terapia}.\n`;
            hda += `Evolu√ß√£o: queixa-se de `;
            if (afet.includes('depress')) hda += `humor deprimido, `;
            if (conteudoPens.includes('suicida')) hda += `idea√ß√£o suicida, `;
            if (sens.includes('alucina√ß√£o')) hda += `${sens}, `;
            if (pensCurso.includes('acelerado')) hda += `pensamento acelerado, `;
            if (psicomot.includes('agitado')) hda += `agita√ß√£o, `;
            hda = hda.replace(/, $/, '') + '.\n';
            hda += `MEEM ${meemTotal}/30. `;

            // exame ps√≠quico
            let exame = `\nEXAME PS√çQUICO:\n`;
            exame += `Consci√™ncia: ${consc}. Aten√ß√£o: ${atenc}. Orienta√ß√£o: ${orient}.\nMem√≥ria: ${mem}. Intelig√™ncia: ${intel}. Sensopercep√ß√£o: ${sens}.\n`;
            exame += `Afeto: ${afet}. Pensamento curso: ${pensCurso}. Conte√∫do: ${conteudoPens}.\nLinguagem: ${ling}. Psicomotricidade: ${psicomot}. Vontade: ${vont}. Ju√≠zo: ${juizo}.\n`;

            // conduta
            let conduta = `\nCONDUTA (autom√°tica):\n`;
            if (conteudoPens.includes('suicida')) conduta += 'üö® Risco de suic√≠dio ‚Äì avaliar necessidade de observa√ß√£o. ';
            if (sens.includes('alucina√ß√£o') && juizo.includes('prejudicado')) conduta += 'Sintomas psic√≥ticos ‚Äì considerar antipsic√≥tico. ';
            if (afet.includes('depress')) conduta += 'Humor deprimido ‚Äì ajustar antidepressivo e psicoterapia. ';
            if (mem.includes('hipomn√©sia') || meemTotal < 24) conduta += 'Investiga√ß√£o de decl√≠nio cognitivo (imagem, laborat√≥rio). ';
            conduta += '\nRetorno em 1-2 semanas, suporte CAPS.';

            document.getElementById('outputFinal').innerText = hda + exame + conduta;
        });

        // copiar
        document.getElementById('copiarTexto').addEventListener('click', function() {
            const texto = document.getElementById('outputFinal').innerText;
            navigator.clipboard.writeText(texto).then(() => alert('‚úÖ Texto copiado!'));
        });
    })();
</script>
</body>
</html>
