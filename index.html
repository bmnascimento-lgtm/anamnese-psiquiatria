<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta Psiqui√°trica - Anamnese com MEEM e Hip√≥tese Autom√°tica</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f4f8;
            padding: 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: #1e3c5c;
            margin-bottom: 25px;
            font-size: 2.2em;
            border-bottom: 4px solid #3498db;
            padding-bottom: 10px;
        }

        h2 {
            color: #2c5282;
            margin: 25px 0 15px 0;
            font-size: 1.5em;
            background: #e8f0fe;
            padding: 10px;
            border-radius: 8px;
        }

        h3 {
            color: #2d3748;
            margin: 15px 0 10px 0;
            font-size: 1.2em;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 6px solid #3498db;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2d3748;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.1);
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 200px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: #27ae60;
        }

        .btn-success:hover {
            background: #219a52;
        }

        .btn-info {
            background: #f39c12;
        }

        .btn-info:hover {
            background: #e67e22;
        }

        .result-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #e2e8f0;
        }

        .hda-display {
            background: #edf7ed;
            padding: 20px;
            border-radius: 8px;
            border-left: 6px solid #27ae60;
            margin: 20px 0;
            font-size: 16px;
            line-height: 1.6;
        }

        .conduta-display {
            background: #fff3e0;
            padding: 20px;
            border-radius: 8px;
            border-left: 6px solid #f39c12;
            margin: 20px 0;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .hd-display {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            border-left: 6px solid #1976d2;
            margin: 20px 0;
            line-height: 1.6;
            font-size: 16px;
        }

        .imc-container {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
        }

        .imc-valor {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .imc-classificacao {
            font-size: 18px;
            padding: 8px;
            border-radius: 20px;
            display: inline-block;
            min-width: 200px;
        }

        .imc-normal { background: #c8e6c9; color: #1b5e20; }
        .imc-sobrepeso { background: #fff9c4; color: #ff6f00; }
        .imc-obesidade1 { background: #ffcc80; color: #e65100; }
        .imc-obesidade2 { background: #ffb74d; color: #bf360c; }
        .imc-obesidade3 { background: #ff8a65; color: #871400; }
        .imc-abaixo { background: #b3e5fc; color: #01579b; }

        .medicamento-item {
            background: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 2px solid #e2e8f0;
            position: relative;
        }

        .btn-remover {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .btn-remover:hover {
            background: #c0392b;
        }

        .sugestoes-perguntas {
            background: #ebf5ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }

        .sugestao-item {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .sugestao-item:before {
            content: "‚Ä¢";
            color: #3498db;
            font-weight: bold;
            position: absolute;
            left: 5px;
        }

        .meem-container {
            background: #f3e5f5;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 6px solid #9b59b6;
        }

        .meem-valor {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #4a148c;
        }

        .meem-classificacao {
            font-size: 18px;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            background: white;
        }

        .meem-referencia {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }

        .pdf-viewer {
            width: 100%;
            height: 500px;
            border: 2px solid #3498db;
            border-radius: 8px;
            margin-top: 15px;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìã Consulta Psiqui√°trica - Anamnese com MEEM e Hip√≥tese Autom√°tica</h1>
        <p style="margin-bottom: 20px; color: #4a5568;">Baseado no DSM-5-TR e diretrizes da ABP | MEEM: Brucki et al. (2003) e Tombaugh & McIntyre (1992)</p>

        <!-- Identifica√ß√£o -->
        <div class="card">
            <h2>1. Identifica√ß√£o do Paciente</h2>
            <div class="grid-4">
                <div class="form-group">
                    <label>Idade (anos)</label>
                    <input type="number" id="idade" min="0" max="120" oninput="calcularIMC(); gerarHDeConduta()">
                </div>
                <div class="form-group">
                    <label>Sexo</label>
                    <select id="sexo" onchange="gerarHDeConduta()">
                        <option value="">Selecione</option>
                        <option value="Feminino">Feminino</option>
                        <option value="Masculino">Masculino</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Peso (kg)</label>
                    <input type="number" id="peso" step="0.1" oninput="calcularIMC()">
                </div>
                <div class="form-group">
                    <label>Altura (m)</label>
                    <input type="number" id="altura" step="0.01" oninput="calcularIMC()">
                </div>
            </div>
            
            <!-- IMC com classifica√ß√£o -->
            <div id="imcContainer" class="imc-container" style="display: none;">
                <div id="imcValor" class="imc-valor"></div>
                <div id="imcClassificacao" class="imc-classificacao"></div>
            </div>
        </div>

        <!-- MEEM - Mini Exame do Estado Mental -->
        <div class="card">
            <h2>2. Mini Exame do Estado Mental (MEEM)</h2>
            
            <!-- Visualizador do PDF do MEEM -->
            <details>
                <summary style="cursor: pointer; color: #3498db; font-weight: 600; margin-bottom: 15px;">üìÑ Clique aqui para visualizar o MEEM original (Brucki et al.)</summary>
                <iframe class="pdf-viewer" src="https://docs.google.com/viewer?url=https://cdn.worsoni.com/pdf/meem-brucki.pdf&embedded=true"></iframe>
            </details>

            <div class="grid-3">
                <div class="form-group">
                    <label>Orienta√ß√£o Temporal (0-5)</label>
                    <input type="number" id="meemTempo" min="0" max="5" step="1" value="0" oninput="calcularMEEM()">
                </div>
                <div class="form-group">
                    <label>Orienta√ß√£o Espacial (0-5)</label>
                    <input type="number" id="meemEspaco" min="0" max="5" step="1" value="0" oninput="calcularMEEM()">
                </div>
                <div class="form-group">
                    <label>Registro (0-3)</label>
                    <input type="number" id="meemRegistro" min="0" max="3" step="1" value="0" oninput="calcularMEEM()">
                </div>
                <div class="form-group">
                    <label>Aten√ß√£o e C√°lculo (0-5)</label>
                    <input type="number" id="meemAtencao" min="0" max="5" step="1" value="0" oninput="calcularMEEM()">
                </div>
                <div class="form-group">
                    <label>Mem√≥ria de Evoca√ß√£o (0-3)</label>
                    <input type="number" id="meemMemoria" min="0" max="3" step="1" value="0" oninput="calcularMEEM()">
                </div>
                <div class="form-group">
                    <label>Linguagem (0-9)</label>
                    <input type="number" id="meemLinguagem" min="0" max="9" step="1" value="0" oninput="calcularMEEM()">
                </div>
            </div>
            
            <div class="form-group">
                <label>Escolaridade (para classifica√ß√£o)</label>
                <select id="escolaridade" onchange="calcularMEEM()">
                    <option value="">Selecione</option>
                    <option value="analfabeto">Analfabeto</option>
                    <option value="baixa">1-4 anos (baixa)</option>
                    <option value="media">5-8 anos (m√©dia)</option>
                    <option value="alta">9+ anos (alta)</option>
                </select>
            </div>

            <!-- Resultado MEEM com classifica√ß√£o -->
            <div id="meemContainer" class="meem-container" style="display: none;">
                <div id="meemValor" class="meem-valor"></div>
                <div id="meemClassificacao" class="meem-classificacao"></div>
                <div class="meem-referencia">
                    <strong>Refer√™ncias:</strong><br>
                    ‚Ä¢ Brucki SMD, Nitrini R, Caramelli P, Bertolucci PHF, Okamoto IH. Sugest√µes para o uso do mini-exame do estado mental no Brasil. Arq Neuropsiquiatr. 2003;61(3-B):777-781.<br>
                    ‚Ä¢ Tombaugh TN, McIntyre NJ. The mini-mental state examination: a comprehensive review. J Am Geriatr Soc. 1992;40(9):922-935.
                </div>
            </div>
        </div>

        <!-- Queixa Principal -->
        <div class="card">
            <h2>3. Queixa Principal</h2>
            <div class="form-group">
                <label>"O que mais incomoda o(a) senhor(a)?"</label>
                <textarea id="queixa" rows="2" oninput="gerarHDeConduta()"></textarea>
            </div>
        </div>

        <!-- Hist√≥ria Pr√©via com perguntas sugestivas -->
        <div class="card">
            <h2>4. Hist√≥ria Pr√©via</h2>
            
            <!-- Sugest√µes de perguntas para psiquiatria -->
            <div class="sugestoes-perguntas">
                <h3 style="margin-top: 0; color: #2980b9;">üí° Perguntas sugeridas para anamnese psiqui√°trica:</h3>
                <div class="grid-2">
                    <div>
                        <div class="sugestao-item">J√° teve epis√≥dios semelhantes antes?</div>
                        <div class="sugestao-item">J√° fez acompanhamento psiqui√°trico ou psicol√≥gico?</div>
                        <div class="sugestao-item">J√° usou medicamentos psiqui√°tricos? Quais?</div>
                        <div class="sugestao-item">J√° teve idea√ß√£o suicida ou tentativas?</div>
                        <div class="sugestao-item">Hist√≥rico de interna√ß√µes psiqui√°tricas?</div>
                        <div class="sugestao-item">Uso de √°lcool, tabaco ou outras drogas?</div>
                    </div>
                    <div>
                        <div class="sugestao-item">Algu√©m na fam√≠lia tem transtorno psiqui√°trico?</div>
                        <div class="sugestao-item">Hist√≥rico familiar de suic√≠dio?</div>
                        <div class="sugestao-item">Doen√ßas cl√≠nicas (DM, HAS, epilepsia, tireoide)?</div>
                        <div class="sugestao-item">Traumas na inf√¢ncia ou adolesc√™ncia?</div>
                        <div class="sugestao-item">Como √© o suporte familiar?</div>
                        <div class="sugestao-item">Trabalha / estuda? Como est√° o desempenho?</div>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div>
                    <h3>Antecedentes Pessoais</h3>
                    <div class="checkbox-group" id="antecedentesPessoais">
                        <div class="checkbox-item"><input type="checkbox" value="Depress√£o" onchange="gerarHDeConduta()"> Depress√£o</div>
                        <div class="checkbox-item"><input type="checkbox" value="Transtorno Bipolar" onchange="gerarHDeConduta()"> Transtorno Bipolar</div>
                        <div class="checkbox-item"><input type="checkbox" value="Ansiedade" onchange="gerarHDeConduta()"> Transtorno de Ansiedade</div>
                        <div class="checkbox-item"><input type="checkbox" value="TOC" onchange="gerarHDeConduta()"> TOC</div>
                        <div class="checkbox-item"><input type="checkbox" value="TAG" onchange="gerarHDeConduta()"> TAG</div>
                        <div class="checkbox-item"><input type="checkbox" value="Transtorno de P√¢nico" onchange="gerarHDeConduta()"> Transtorno de P√¢nico</div>
                        <div class="checkbox-item"><input type="checkbox" value="Estresse P√≥s-Traum√°tico" onchange="gerarHDeConduta()"> Estresse P√≥s-Traum√°tico</div>
                        <div class="checkbox-item"><input type="checkbox" value="Esquizofrenia" onchange="gerarHDeConduta()"> Esquizofrenia</div>
                        <div class="checkbox-item"><input type="checkbox" value="Transtorno Esquizoafetivo" onchange="gerarHDeConduta()"> Transtorno Esquizoafetivo</div>
                        <div class="checkbox-item"><input type="checkbox" value="Transtorno Alimentar" onchange="gerarHDeConduta()"> Transtorno Alimentar</div>
                        <div class="checkbox-item"><input type="checkbox" value="Transtorno de Personalidade" onchange="gerarHDeConduta()"> Transtorno de Personalidade</div>
                        <div class="checkbox-item"><input type="checkbox" value="TDAH" onchange="gerarHDeConduta()"> TDAH</div>
                        <div class="checkbox-item"><input type="checkbox" value="Tentativa de suic√≠dio" onchange="gerarHDeConduta()"> Tentativa de suic√≠dio</div>
                        <div class="checkbox-item"><input type="checkbox" value="Interna√ß√£o psiqui√°trica" onchange="gerarHDeConduta()"> Interna√ß√£o psiqui√°trica</div>
                    </div>
                </div>
                
                <div>
                    <h3>Antecedentes Familiares</h3>
                    <div class="checkbox-group" id="antecedentesFamiliares">
                        <div class="checkbox-item"><input type="checkbox" value="Depress√£o familiar" onchange="gerarHDeConduta()"> Depress√£o</div>
                        <div class="checkbox-item"><input type="checkbox" value="Transtorno Bipolar familiar" onchange="gerarHDeConduta()"> Transtorno Bipolar</div>
                        <div class="checkbox-item"><input type="checkbox" value="Ansiedade familiar" onchange="gerarHDeConduta()"> Ansiedade</div>
                        <div class="checkbox-item"><input type="checkbox" value="Esquizofrenia familiar" onchange="gerarHDeConduta()"> Esquizofrenia</div>
                        <div class="checkbox-item"><input type="checkbox" value="TOC familiar" onchange="gerarHDeConduta()"> TOC</div>
                        <div class="checkbox-item"><input type="checkbox" value="TAG familiar" onchange="gerarHDeConduta()"> TAG</div>
                        <div class="checkbox-item"><input type="checkbox" value="Suic√≠dio familiar" onchange="gerarHDeConduta()"> Suic√≠dio</div>
                        <div class="checkbox-item"><input type="checkbox" value="Alcoolismo familiar" onchange="gerarHDeConduta()"> Alcoolismo</div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Alergias</label>
                <input type="text" id="alergias" oninput="gerarHDeConduta()">
            </div>
        </div>

        <!-- Medicamentos -->
        <div class="card">
            <h2>5. Medicamentos em Uso</h2>
            <div id="medicamentos-container"></div>
            <button class="btn" type="button" onclick="adicionarMedicamento()">+ Adicionar Medicamento</button>
        </div>

        <!-- Terapias -->
        <div class="card">
            <h2>6. Terapias em Realiza√ß√£o</h2>
            
            <div class="grid-3">
                <div class="form-group">
                    <label>Psicoterapia</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="psicoterapia" value="sim" onchange="toggleTerapiaCampos('psico'); gerarHDeConduta()"> Sim
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="psicoterapia" value="nao" onchange="toggleTerapiaCampos('psico'); gerarHDeConduta()" checked> N√£o
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Grupo de apoio</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="grupo" value="sim" onchange="toggleTerapiaCampos('grupo'); gerarHDeConduta()"> Sim
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="grupo" value="nao" onchange="toggleTerapiaCampos('grupo'); gerarHDeConduta()" checked> N√£o
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Terapia ocupacional</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="to" value="sim" onchange="toggleTerapiaCampos('to'); gerarHDeConduta()"> Sim
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="to" value="nao" onchange="toggleTerapiaCampos('to'); gerarHDeConduta()" checked> N√£o
                        </div>
                    </div>
                </div>
            </div>

            <div id="camposPsico" style="display: none;" class="grid-2">
                <div class="form-group">
                    <label>Onde realiza psicoterapia?</label>
                    <input type="text" id="ondePsico" oninput="gerarHDeConduta()">
                </div>
                <div class="form-group">
                    <label>Desde quando?</label>
                    <input type="text" id="desdePsico" oninput="gerarHDeConduta()">
                </div>
            </div>

            <div id="camposGrupo" style="display: none;" class="grid-2">
                <div class="form-group">
                    <label>Onde participa do grupo?</label>
                    <input type="text" id="ondeGrupo" oninput="gerarHDeConduta()">
                </div>
                <div class="form-group">
                    <label>Desde quando?</label>
                    <input type="text" id="desdeGrupo" oninput="gerarHDeConduta()">
                </div>
            </div>

            <div id="camposTO" style="display: none;" class="grid-2">
                <div class="form-group">
                    <label>Onde realiza TO?</label>
                    <input type="text" id="ondeTO" oninput="gerarHDeConduta()">
                </div>
                <div class="form-group">
                    <label>Desde quando?</label>
                    <input type="text" id="desdeTO" oninput="gerarHDeConduta()">
                </div>
            </div>
        </div>

        <!-- Hist√≥ria da Doen√ßa Atual -->
        <div class="card">
            <h2>7. Hist√≥ria da Doen√ßa Atual (HDA)</h2>
            <div class="grid-3">
                <div class="form-group">
                    <label>In√≠cio dos sintomas</label>
                    <input type="text" id="inicio" oninput="gerarHDeConduta()">
                </div>
                <div class="form-group">
                    <label>In√≠cio foi s√∫bito ou gradual?</label>
                    <input type="text" id="tipoInicio" oninput="gerarHDeConduta()">
                </div>
                <div class="form-group">
                    <label>Fatores desencadeantes</label>
                    <input type="text" id="fatoresDesencadeantes" oninput="gerarHDeConduta()">
                </div>
            </div>

            <h3>Sintomas Associados</h3>
            <div class="checkbox-group" id="sintomas">
                <div class="checkbox-item"><input type="checkbox" value="Tristeza" onchange="gerarHDeConduta()"> Tristeza</div>
                <div class="checkbox-item"><input type="checkbox" value="Anedonia" onchange="gerarHDeConduta()"> Anedonia</div>
                <div class="checkbox-item"><input type="checkbox" value="Ansiedade" onchange="gerarHDeConduta()"> Ansiedade</div>
                <div class="checkbox-item"><input type="checkbox" value="Ins√¥nia" onchange="gerarHDeConduta()"> Ins√¥nia</div>
                <div class="checkbox-item"><input type="checkbox" value="Hipersonia" onchange="gerarHDeConduta()"> Hipersonia</div>
                <div class="checkbox-item"><input type="checkbox" value="Fadiga" onchange="gerarHDeConduta()"> Fadiga</div>
                <div class="checkbox-item"><input type="checkbox" value="Irritabilidade" onchange="gerarHDeConduta()"> Irritabilidade</div>
                <div class="checkbox-item"><input type="checkbox" value="Apatia" onchange="gerarHDeConduta()"> Apatia</div>
                <div class="checkbox-item"><input type="checkbox" value="Idea√ß√£o suicida" onchange="gerarHDeConduta()"> Idea√ß√£o suicida</div>
                <div class="checkbox-item"><input type="checkbox" value="Alucina√ß√µes" onchange="gerarHDeConduta()"> Alucina√ß√µes</div>
                <div class="checkbox-item"><input type="checkbox" value="Del√≠rios" onchange="gerarHDeConduta()"> Del√≠rios</div>
                <div class="checkbox-item"><input type="checkbox" value="Agita√ß√£o" onchange="gerarHDeConduta()"> Agita√ß√£o</div>
                <div class="checkbox-item"><input type="checkbox" value="Lentifica√ß√£o" onchange="gerarHDeConduta()"> Lentifica√ß√£o</div>
                <div class="checkbox-item"><input type="checkbox" value="Compuls√µes" onchange="gerarHDeConduta()"> Compuls√µes</div>
                <div class="checkbox-item"><input type="checkbox" value="Obsess√µes" onchange="gerarHDeConduta()"> Obsess√µes</div>
            </div>

            <div class="grid-2">
                <div>
                    <h3>Fatores de Melhora</h3>
                    <div class="checkbox-group" id="melhora">
                        <div class="checkbox-item"><input type="checkbox" value="Medica√ß√£o" onchange="gerarHDeConduta()"> Medica√ß√£o</div>
                        <div class="checkbox-item"><input type="checkbox" value="Terapia" onchange="gerarHDeConduta()"> Terapia</div>
                        <div class="checkbox-item"><input type="checkbox" value="Atividade f√≠sica" onchange="gerarHDeConduta()"> Atividade f√≠sica</div>
                        <div class="checkbox-item"><input type="checkbox" value="Lazer" onchange="gerarHDeConduta()"> Lazer</div>
                        <div class="checkbox-item"><input type="checkbox" value="Conv√≠vio social" onchange="gerarHDeConduta()"> Conv√≠vio social</div>
                        <div class="checkbox-item"><input type="checkbox" value="Rotina estruturada" onchange="gerarHDeConduta()"> Rotina estruturada</div>
                    </div>
                </div>
                
                <div>
                    <h3>Fatores de Piora</h3>
                    <div class="checkbox-group" id="piora">
                        <div class="checkbox-item"><input type="checkbox" value="Estresse" onchange="gerarHDeConduta()"> Estresse</div>
                        <div class="checkbox-item"><input type="checkbox" value="Conflitos familiares" onchange="gerarHDeConduta()"> Conflitos familiares</div>
                        <div class="checkbox-item"><input type="checkbox" value="Isolamento" onchange="gerarHDeConduta()"> Isolamento</div>
                        <div class="checkbox-item"><input type="checkbox" value="Priva√ß√£o de sono" onchange="gerarHDeConduta()"> Priva√ß√£o de sono</div>
                        <div class="checkbox-item"><input type="checkbox" value="Uso de subst√¢ncias" onchange="gerarHDeConduta()"> Uso de subst√¢ncias</div>
                        <div class="checkbox-item"><input type="checkbox" value="√Ålcool" onchange="gerarHDeConduta()"> √Ålcool</div>
                        <div class="checkbox-item"><input type="checkbox" value="Problemas financeiros" onchange="gerarHDeConduta()"> Problemas financeiros</div>
                        <div class="checkbox-item"><input type="checkbox" value="Lembran√ßas traum√°ticas" onchange="gerarHDeConduta()"> Lembran√ßas traum√°ticas</div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Tratamentos pr√©vios realizados</label>
                <textarea id="tratamentosPrevios" rows="2" oninput="gerarHDeConduta()"></textarea>
            </div>
        </div>

        <!-- Hip√≥teses Diagn√≥sticas Geradas Automaticamente -->
        <div class="card">
            <h2>8. Hip√≥teses Diagn√≥sticas (Geradas Automaticamente)</h2>
            <div id="hdDisplay" class="hd-display">
                <strong>Hip√≥tese Diagn√≥stica:</strong> Aguardando informa√ß√µes...<br>
                <strong>Diagn√≥stico(s) Diferencial(is):</strong> --
            </div>
        </div>

        <!-- Conduta Gerada Automaticamente -->
        <div class="card">
            <h2>9. Conduta (Gerada Automaticamente)</h2>
            <div id="condutaGerada" class="conduta-display">
                <strong>Conduta baseada em evid√™ncias ser√° gerada automaticamente...</strong>
            </div>

            <div class="form-group">
                <label>Exames Complementares</label>
                <div class="checkbox-group" id="exames">
                    <div class="checkbox-item"><input type="checkbox" value="Hemograma" onchange="gerarCondutaAutomatica()"> Hemograma</div>
                    <div class="checkbox-item"><input type="checkbox" value="Glicemia" onchange="gerarCondutaAutomatica()"> Glicemia</div>
                    <div class="checkbox-item"><input type="checkbox" value="Fun√ß√£o tireoidiana" onchange="gerarCondutaAutomatica()"> Fun√ß√£o tireoidiana</div>
                    <div class="checkbox-item"><input type="checkbox" value="Vitamina B12" onchange="gerarCondutaAutomatica()"> Vitamina B12</div>
                    <div class="checkbox-item"><input type="checkbox" value="√Åcido f√≥lico" onchange="gerarCondutaAutomatica()"> √Åcido f√≥lico</div>
                    <div class="checkbox-item"><input type="checkbox" value="ECG" onchange="gerarCondutaAutomatica()"> ECG</div>
                    <div class="checkbox-item"><input type="checkbox" value="Sorologias" onchange="gerarCondutaAutomatica()"> Sorologias</div>
                </div>
            </div>
        </div>

        <!-- Bot√µes Finais -->
        <div style="display: flex; gap: 10px; margin: 30px 0; flex-wrap: wrap;">
            <button class="btn btn-success" onclick="gerarRelatorioCompleto()">üìã Gerar Relat√≥rio Completo</button>
            <button class="btn" onclick="copiarTexto()">üìã Copiar Relat√≥rio</button>
            <button class="btn" onclick="limparFormulario()">üîÑ Nova Consulta</button>
        </div>

        <!-- Relat√≥rio Completo -->
        <div class="result-box" id="relatorioCompleto" style="display:none;">
            <h3>üìÑ RELAT√ìRIO DA CONSULTA PSIQUI√ÅTRICA</h3>
            <div id="conteudoRelatorio" style="white-space: pre-wrap; line-height: 1.6;"></div>
        </div>
        
        <footer>
            Baseado no DSM-5-TR e diretrizes da Associa√ß√£o Brasileira de Psiquiatria | MEEM: Brucki et al. (2003) e Tombaugh & McIntyre (1992)
        </footer>
    </div>

    <script>
        // Fun√ß√µes IMC
        function calcularIMC() {
            const peso = parseFloat(document.getElementById('peso').value);
            const altura = parseFloat(document.getElementById('altura').value);
            const imcContainer = document.getElementById('imcContainer');
            const imcValor = document.getElementById('imcValor');
            const imcClassificacao = document.getElementById('imcClassificacao');
            
            if (peso && altura && peso > 0 && altura > 0) {
                const imc = peso / (altura * altura);
                const imcArredondado = imc.toFixed(2);
                const classificacao = classificarIMC(imc);
                const classeCSS = getIMCClass(imc);
                
                imcContainer.style.display = 'block';
                imcValor.innerHTML = `IMC: ${imcArredondado} kg/m¬≤`;
                imcClassificacao.innerHTML = classificacao;
                imcClassificacao.className = `imc-classificacao ${classeCSS}`;
            } else {
                imcContainer.style.display = 'none';
            }
        }

        function classificarIMC(imc) {
            if (imc < 18.5) return 'Abaixo do peso';
            if (imc < 25) return 'Peso normal';
            if (imc < 30) return 'Sobrepeso';
            if (imc < 35) return 'Obesidade grau I';
            if (imc < 40) return 'Obesidade grau II';
            return 'Obesidade grau III';
        }

        function getIMCClass(imc) {
            if (imc < 18.5) return 'imc-abaixo';
            if (imc < 25) return 'imc-normal';
            if (imc < 30) return 'imc-sobrepeso';
            if (imc < 35) return 'imc-obesidade1';
            if (imc < 40) return 'imc-obesidade2';
            return 'imc-obesidade3';
        }

        // Fun√ß√µes MEEM
        function calcularMEEM() {
            const tempo = parseInt(document.getElementById('meemTempo').value) || 0;
            const espaco = parseInt(document.getElementById('meemEspaco').value) || 0;
            const registro = parseInt(document.getElementById('meemRegistro').value) || 0;
            const atencao = parseInt(document.getElementById('meemAtencao').value) || 0;
            const memoria = parseInt(document.getElementById('meemMemoria').value) || 0;
            const linguagem = parseInt(document.getElementById('meemLinguagem').value) || 0;
            
            const total = tempo + espaco + registro + atencao + memoria + linguagem;
            
            const meemContainer = document.getElementById('meemContainer');
            const meemValor = document.getElementById('meemValor');
            const meemClassificacao = document.getElementById('meemClassificacao');
            
            const escolaridade = document.getElementById('escolaridade').value;
            
            if (total > 0 && escolaridade) {
                meemContainer.style.display = 'block';
                meemValor.innerHTML = `MEEM: ${total}/30`;
                
                const classificacao = classificarMEEM(total, escolaridade);
                meemClassificacao.innerHTML = classificacao;
            } else if (total > 0) {
                meemContainer.style.display = 'block';
                meemValor.innerHTML = `MEEM: ${total}/30`;
                meemClassificacao.innerHTML = 'Selecione a escolaridade para classifica√ß√£o';
            } else {
                meemContainer.style.display = 'none';
            }
            
            gerarHDeConduta();
        }

        function classificarMEEM(pontuacao, escolaridade) {
            // Baseado em Brucki et al. (2003) - pontos de corte para popula√ß√£o brasileira
            let resultado = '';
            
            switch(escolaridade) {
                case 'analfabeto':
                    if (pontuacao <= 18) resultado = 'Prov√°vel decl√≠nio cognitivo (ponto de corte: 18)';
                    else if (pontuacao <= 22) resultado = 'Poss√≠vel decl√≠nio cognitivo - acompanhar';
                    else resultado = 'Dentro do esperado para analfabetos';
                    break;
                case 'baixa':
                    if (pontuacao <= 20) resultado = 'Prov√°vel decl√≠nio cognitivo (ponto de corte: 20)';
                    else if (pontuacao <= 24) resultado = 'Poss√≠vel decl√≠nio cognitivo - acompanhar';
                    else resultado = 'Dentro do esperado para 1-4 anos';
                    break;
                case 'media':
                    if (pontuacao <= 22) resultado = 'Prov√°vel decl√≠nio cognitivo (ponto de corte: 22)';
                    else if (pontuacao <= 26) resultado = 'Poss√≠vel decl√≠nio cognitivo - acompanhar';
                    else resultado = 'Dentro do esperado para 5-8 anos';
                    break;
                case 'alta':
                    if (pontuacao <= 24) resultado = 'Prov√°vel decl√≠nio cognitivo (ponto de corte: 24)';
                    else if (pontuacao <= 28) resultado = 'Poss√≠vel decl√≠nio cognitivo - acompanhar';
                    else resultado = 'Dentro do esperado para 9+ anos';
                    break;
                default:
                    resultado = 'Selecione a escolaridade';
            }
            
            // Complemento com Tombaugh & McIntyre (1992)
            if (pontuacao <= 10) resultado += ' | Grave (Tombaugh & McIntyre)';
            else if (pontuacao <= 18) resultado += ' | Moderado a Grave';
            else if (pontuacao <= 23) resultado += ' | Leve a Moderado';
            else if (pontuacao <= 26) resultado += ' | Lim√≠trofe';
            
            return resultado;
        }

        // Fun√ß√µes para Medicamentos
        let contadorMedicamentos = 1;

        function adicionarMedicamento() {
            const container = document.getElementById('medicamentos-container');
            const novoMed = document.createElement('div');
            novoMed.className = 'medicamento-item';
            novoMed.id = `med-${contadorMedicamentos}`;
            
            novoMed.innerHTML = `
                <button class="btn-remover" type="button" onclick="removerMedicamento('med-${contadorMedicamentos}')">‚úï Remover</button>
                <div class="grid-3">
                    <div class="form-group">
                        <label>Medicamento</label>
                        <input type="text" id="medNome-${contadorMedicamentos}" oninput="gerarHDeConduta()">
                    </div>
                    <div class="form-group">
                        <label>Dose</label>
                        <input type="text" id="medDose-${contadorMedicamentos}" oninput="gerarHDeConduta()">
                    </div>
                    <div class="form-group">
                        <label>Tempo de uso</label>
                        <input type="text" id="medTempo-${contadorMedicamentos}" oninput="gerarHDeConduta()">
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>Indica√ß√£o</label>
                        <input type="text" id="medIndicacao-${contadorMedicamentos}" oninput="gerarHDeConduta()">
                    </div>
                    <div class="form-group">
                        <label>Resposta</label>
                        <input type="text" id="medResposta-${contadorMedicamentos}" oninput="gerarHDeConduta()">
                    </div>
                </div>
            `;
            
            container.appendChild(novoMed);
            contadorMedicamentos++;
        }

        function removerMedicamento(id) {
            const elemento = document.getElementById(id);
            if (elemento) {
                elemento.remove();
                gerarHDeConduta();
            }
        }

        // Fun√ß√µes para Terapias
        function toggleTerapiaCampos(tipo) {
            const radios = document.getElementsByName(tipo === 'psico' ? 'psicoterapia' : 
                                                     tipo === 'grupo' ? 'grupo' : 'to');
            let valor = '';
            
            for (const radio of radios) {
                if (radio.checked) {
                    valor = radio.value;
                    break;
                }
            }
            
            const camposId = tipo === 'psico' ? 'camposPsico' : 
                             tipo === 'grupo' ? 'camposGrupo' : 'camposTO';
            
            document.getElementById(camposId).style.display = valor === 'sim' ? 'grid' : 'none';
        }

        // Fun√ß√£o principal que gera hip√≥tese e conduta automaticamente
        function gerarHDeConduta() {
            const hipotese = gerarHipoteseDiagnostica();
            const diferencial = gerarDiagnosticoDiferencial(hipotese);
            
            document.getElementById('hdDisplay').innerHTML = `
                <strong>Hip√≥tese Diagn√≥stica:</strong> ${hipotese}<br>
                <strong>Diagn√≥stico(s) Diferencial(is):</strong> ${diferencial}
            `;
            
            gerarCondutaAutomatica(hipotese);
        }

        function gerarHipoteseDiagnostica() {
            const sintomas = Array.from(document.querySelectorAll('#sintomas input:checked')).map(cb => cb.value);
            const pessoais = Array.from(document.querySelectorAll('#antecedentesPessoais input:checked')).map(cb => cb.value);
            const fatoresPiora = Array.from(document.querySelectorAll('#piora input:checked')).map(cb => cb.value);
            const inicio = document.getElementById('inicio').value;
            
            let hipotese = "Transtorno mental a esclarecer";
            
            // L√≥gica para gerar hip√≥tese baseada nos sintomas
            if (sintomas.includes('Tristeza') && sintomas.includes('Anedonia') && sintomas.includes('Fadiga')) {
                if (pessoais.includes('Transtorno Bipolar')) {
                    hipotese = "Transtorno Depressivo (epis√≥dio atual) - investigar espectro bipolar";
                } else {
                    hipotese = "Transtorno Depressivo Maior - epis√≥dio atual";
                }
            }
            else if (sintomas.includes('Ansiedade') && sintomas.includes('Ins√¥nia') && sintomas.includes('Irritabilidade')) {
                hipotese = "Transtorno de Ansiedade Generalizada (TAG)";
            }
            else if (sintomas.includes('Alucina√ß√µes') || sintomas.includes('Del√≠rios')) {
                if (pessoais.includes('Transtorno Bipolar')) {
                    hipotese = "Transtorno Bipolar - epis√≥dio atual com sintomas psic√≥ticos";
                } else {
                    hipotese = "Transtorno Psic√≥tico (Esquizofrenia? Transtorno Esquizoafetivo?)";
                }
            }
            else if (sintomas.includes('Obsess√µes') || sintomas.includes('Compuls√µes')) {
                hipotese = "Transtorno Obsessivo-Compulsivo (TOC)";
            }
            else if (sintomas.includes('Idea√ß√£o suicida')) {
                hipotese = "Transtorno Depressivo com idea√ß√£o suicida - avaliar risco";
            }
            else if (fatoresPiora.includes('Uso de subst√¢ncias') || fatoresPiora.includes('√Ålcool')) {
                hipotese = "Transtorno por Uso de Subst√¢ncias - investigar comorbidades";
            }
            
            // Refinar baseado no MEEM
            const meemTotal = calcularTotalMEEM();
            if (meemTotal > 0 && meemTotal < 24) {
                hipotese += " com poss√≠vel comprometimento cognitivo associado";
            }
            
            return hipotese;
        }

        function gerarDiagnosticoDiferencial(hipotese) {
            const diferenciais = {
                "Transtorno Depressivo Maior": "Transtorno Bipolar (epis√≥dio depressivo), Transtorno de Ajustamento, Transtorno de Ansiedade, Hipotiroidismo",
                "Transtorno de Ansiedade Generalizada": "Transtorno de P√¢nico, Transtorno Depressivo, Transtorno de Estresse P√≥s-Traum√°tico",
                "Transtorno Psic√≥tico": "Transtorno Bipolar com sintomas psic√≥ticos, Transtorno Esquizoafetivo, Delirium, Dem√™ncia",
                "TOC": "Transtorno de Ansiedade, Transtorno de Personalidade Obsessivo-Compulsiva, Transtorno de Tourette",
                "Transtorno Bipolar": "Transtorno Depressivo Maior, Transtorno de Personalidade Borderline, TDAH",
                "Transtorno por Uso de Subst√¢ncias": "Transtorno Bipolar, Transtorno de Ansiedade, Transtorno de Personalidade"
            };
            
            for (const [chave, valor] of Object.entries(diferenciais)) {
                if (hipotese.includes(chave)) {
                    return valor;
                }
            }
            
            return "Transtorno de Ansiedade, Transtorno Depressivo, Transtorno de Ajustamento";
        }

        function calcularTotalMEEM() {
            const tempo = parseInt(document.getElementById('meemTempo').value) || 0;
            const espaco = parseInt(document.getElementById('meemEspaco').value) || 0;
            const registro = parseInt(document.getElementById('meemRegistro').value) || 0;
            const atencao = parseInt(document.getElementById('meemAtencao').value) || 0;
            const memoria = parseInt(document.getElementById('meemMemoria').value) || 0;
            const linguagem = parseInt(document.getElementById('meemLinguagem').value) || 0;
            
            return tempo + espaco + registro + atencao + memoria + linguagem;
        }

        function gerarCondutaAutomatica(hipotese) {
            const examesSelecionados = Array.from(document.querySelectorAll('#exames input:checked')).map(cb => cb.value);
            const meemTotal = calcularTotalMEEM();
            
            let conduta = `**CONDUTA BASEADA EM EVID√äNCIAS**\n\n`;
            conduta += `Com base na hip√≥tese diagn√≥stica de "${hipotese}", recomenda-se:\n\n`;
            
            // Orienta√ß√µes gerais
            conduta += `1. **ORIENTA√á√ïES GERAIS:**\n`;
            conduta += `   ‚Ä¢ Psicoeduca√ß√£o sobre o transtorno e tratamento\n`;
            conduta += `   ‚Ä¢ Orientar sobre higiene do sono\n`;
            conduta += `   ‚Ä¢ Estimular atividade f√≠sica regular\n`;
            conduta += `   ‚Ä¢ Evitar √°lcool e outras subst√¢ncias\n`;
            conduta += `   ‚Ä¢ Fortalecer rede de apoio\n\n`;
            
            // Orienta√ß√µes espec√≠ficas por hip√≥tese
            conduta += `2. **TRATAMENTO FARMACOL√ìGICO:**\n`;
            
            if (hipotese.includes("Transtorno Depressivo")) {
                conduta += `   ‚Ä¢ ISRS (Fluoxetina 20mg/dia, Sertralina 50mg/dia, Escitalopram 10mg/dia)\n`;
                conduta += `   ‚Ä¢ Ajuste conforme resposta e tolerabilidade\n`;
                conduta += `   ‚Ä¢ Avaliar resposta em 2-4 semanas\n`;
                if (hipotese.includes("idea√ß√£o suicida")) {
                    conduta += `   ‚Ä¢ ALERTA: Risco de suic√≠dio - monitorar de perto\n`;
                }
            } else if (hipotese.includes("Ansiedade")) {
                conduta += `   ‚Ä¢ ISRS (Escitalopram, Sertralina) em doses baixas\n`;
                conduta += `   ‚Ä¢ Evitar benzodiazep√≠nicos a longo prazo\n`;
                conduta += `   ‚Ä¢ Considerar betabloqueadores para sintomas f√≠sicos\n`;
            } else if (hipotese.includes("Psic√≥tico") || hipotese.includes("Esquizofrenia")) {
                conduta += `   ‚Ä¢ Antipsic√≥tico at√≠pico (Risperidona 1-6mg/dia, Quetiapina, Olanzapina)\n`;
                conduta += `   ‚Ä¢ Monitorar efeitos extrapiramidais e metab√≥licos\n`;
            } else if (hipotese.includes("TOC")) {
                conduta += `   ‚Ä¢ ISRS em doses altas (Fluoxetina at√© 80mg, Sertralina at√© 200mg)\n`;
                conduta += `   ‚Ä¢ Considerar Clomipramina se refrat√°rio\n`;
            } else if (hipotese.includes("Transtorno Bipolar")) {
                conduta += `   ‚Ä¢ Estabilizador de humor (L√≠tio, √Åcido Valproico)\n`;
                conduta += `   ‚Ä¢ Evitar antidepressivos em monoterapia\n`;
            } else {
                conduta += `   ‚Ä¢ Iniciar/ajustar medica√ß√£o conforme hip√≥tese diagn√≥stica\n`;
            }
            
            conduta += `\n3. **TRATAMENTO N√ÉO FARMACOL√ìGICO:**\n`;
            conduta += `   ‚Ä¢ Encaminhamento para psicoterapia (TCC, interpessoal)\n`;
            
            const psicoSim = document.querySelector('input[name="psicoterapia"][value="sim"]')?.checked;
            if (psicoSim) {
                const onde = document.getElementById('ondePsico')?.value || 'local a informar';
                const desde = document.getElementById('desdePsico')?.value || 'data a informar';
                conduta += `   ‚Ä¢ Paciente j√° em psicoterapia (${onde}, ${desde}) - manter\n`;
            }
            
            conduta += `\n4. **EXAMES COMPLEMENTARES:**\n`;
            if (examesSelecionados.length > 0) {
                examesSelecionados.forEach(exame => conduta += `   ‚Ä¢ Solicitar ${exame}\n`);
            } else {
                conduta += `   ‚Ä¢ Considerar: hemograma, fun√ß√£o tireoidiana, vitamina B12 (avaliar causas org√¢nicas)\n`;
            }
            
            // Recomenda√ß√£o baseada no MEEM
            if (meemTotal > 0 && meemTotal < 24) {
                conduta += `\n5. **AVALIA√á√ÉO COGNITIVA:**\n`;
                conduta += `   ‚Ä¢ MEEM com pontua√ß√£o ${meemTotal}/30 - considerar avalia√ß√£o neuropsicol√≥gica\n`;
                conduta += `   ‚Ä¢ Investigar causas de decl√≠nio cognitivo\n`;
            }
            
            conduta += `\n6. **RETORNO E SEGURAN√áA:**\n`;
            conduta += `   ‚Ä¢ Agendar retorno em 2-4 semanas\n`;
            conduta += `   ‚Ä¢ Orientar contato em caso de piora ou idea√ß√£o suicida\n`;
            conduta += `   ‚Ä¢ Avaliar risco e prote√ß√£o\n`;
            
            document.getElementById('condutaGerada').innerHTML = conduta.replace(/\n/g, '<br>');
        }

        // Fun√ß√£o para gerar relat√≥rio completo
        function gerarRelatorioCompleto() {
            let relatorio = '';
            
            // Identifica√ß√£o
            const idade = document.getElementById('idade').value || 'N√£o informada';
            const sexo = document.getElementById('sexo').value || 'N√£o informado';
            const peso = document.getElementById('peso').value || 'N√£o informado';
            const altura = document.getElementById('altura').value || 'N√£o informado';
            
            relatorio += `**IDENTIFICA√á√ÉO**\n`;
            relatorio += `Idade: ${idade} | Sexo: ${sexo}\n`;
            relatorio += `Peso: ${peso}kg | Altura: ${altura}m\n`;
            
            if (peso !== 'N√£o informado' && altura !== 'N√£o informado' && !isNaN(peso) && !isNaN(altura) && peso > 0 && altura > 0) {
                const imc = (parseFloat(peso) / (parseFloat(altura) * parseFloat(altura))).toFixed(2);
                const classificacao = classificarIMC(parseFloat(imc));
                relatorio += `IMC: ${imc} kg/m¬≤ (${classificacao})\n`;
            }
            relatorio += `\n`;
            
            // MEEM
            const meemValor = document.getElementById('meemValor')?.innerText;
            const meemClassificacao = document.getElementById('meemClassificacao')?.innerText;
            
            if (meemValor) {
                relatorio += `**MINI EXAME DO ESTADO MENTAL**\n`;
                relatorio += `${meemValor}\n`;
                if (meemClassificacao) relatorio += `Classifica√ß√£o: ${meemClassificacao}\n\n`;
            }
            
            // Queixa Principal
            const queixa = document.getElementById('queixa').value || 'N√£o informada';
            relatorio += `**QUEIXA PRINCIPAL**\n${queixa}\n\n`;
            
            // Antecedentes
            relatorio += `**ANTECEDENTES**\n`;
            const pessoais = Array.from(document.querySelectorAll('#antecedentesPessoais input:checked')).map(cb => cb.value);
            relatorio += `Pessoais: ${pessoais.length > 0 ? pessoais.join(', ') : 'Nenhum informado'}\n`;
            
            const familiares = Array.from(document.querySelectorAll('#antecedentesFamiliares input:checked')).map(cb => cb.value);
            relatorio += `Familiares: ${familiares.length > 0 ? familiares.join(', ') : 'Nenhum informado'}\n`;
            
            const alergias = document.getElementById('alergias').value;
            if (alergias) relatorio += `Alergias: ${alergias}\n`;
            relatorio += `\n`;
            
            // Medicamentos
            relatorio += `**MEDICAMENTOS EM USO**\n`;
            const medicamentos = document.querySelectorAll('#medicamentos-container .medicamento-item');
            
            if (medicamentos.length > 0) {
                medicamentos.forEach((med, index) => {
                    const inputs = med.querySelectorAll('input');
                    const nome = inputs[0]?.value || 'N√£o informado';
                    const dose = inputs[1]?.value || '';
                    const tempo = inputs[2]?.value || '';
                    const indicacao = inputs[3]?.value || '';
                    const resposta = inputs[4]?.value || '';
                    
                    relatorio += `${index+1}. ${nome}`;
                    if (dose) relatorio += ` - ${dose}`;
                    if (tempo) relatorio += ` (${tempo})`;
                    if (indicacao) relatorio += ` - Indica√ß√£o: ${indicacao}`;
                    if (resposta) relatorio += ` - Resposta: ${resposta}`;
                    relatorio += `\n`;
                });
            } else {
                relatorio += `Nenhum medicamento informado\n`;
            }
            relatorio += `\n`;
            
            // Terapias
            relatorio += `**TERAPIAS EM REALIZA√á√ÉO**\n`;
            
            const psicoSim = document.querySelector('input[name="psicoterapia"][value="sim"]')?.checked;
            if (psicoSim) {
                const onde = document.getElementById('ondePsico')?.value || 'local n√£o informado';
                const desde = document.getElementById('desdePsico')?.value || 'data n√£o informada';
                relatorio += `Psicoterapia: Sim (${onde}, ${desde})\n`;
            } else {
                relatorio += `Psicoterapia: N√£o\n`;
            }
            
            const grupoSim = document.querySelector('input[name="grupo"][value="sim"]')?.checked;
            if (grupoSim) {
                const onde = document.getElementById('ondeGrupo')?.value || 'local n√£o informado';
                const desde = document.getElementById('desdeGrupo')?.value || 'data n√£o informada';
                relatorio += `Grupo de apoio: Sim (${onde}, ${desde})\n`;
            } else {
                relatorio += `Grupo de apoio: N√£o\n`;
            }
            
            const toSim = document.querySelector('input[name="to"][value="sim"]')?.checked;
            if (toSim) {
                const onde = document.getElementById('ondeTO')?.value || 'local n√£o informado';
                const desde = document.getElementById('desdeTO')?.value || 'data n√£o informada';
                relatorio += `Terapia Ocupacional: Sim (${onde}, ${desde})\n`;
            } else {
                relatorio += `Terapia Ocupacional: N√£o\n`;
            }
            relatorio += `\n`;
            
            // HDA
            const inicio = document.getElementById('inicio').value;
            const tipoInicio = document.getElementById('tipoInicio').value;
            const fatores = document.getElementById('fatoresDesencadeantes').value;
            const sintomas = Array.from(document.querySelectorAll('#sintomas input:checked')).map(cb => cb.value);
            const melhora = Array.from(document.querySelectorAll('#melhora input:checked')).map(cb => cb.value);
            const piora = Array.from(document.querySelectorAll('#piora input:checked')).map(cb => cb.value);
            
            relatorio += `**HIST√ìRIA DA DOEN√áA ATUAL**\n`;
            if (inicio) relatorio += `In√≠cio: ${inicio}\n`;
            if (tipoInicio) relatorio += `Tipo de in√≠cio: ${tipoInicio}\n`;
            if (fatores) relatorio += `Fatores desencadeantes: ${fatores}\n`;
            if (sintomas.length > 0) relatorio += `Sintomas: ${sintomas.join(', ')}\n`;
            if (melhora.length > 0) relatorio += `Fatores de melhora: ${melhora.join(', ')}\n`;
            if (piora.length > 0) relatorio += `Fatores de piora: ${piora.join(', ')}\n`;
            relatorio += `\n`;
            
            // Hip√≥teses e Conduta
            relatorio += `**HIP√ìTESES DIAGN√ìSTICAS**\n`;
            relatorio += document.getElementById('hdDisplay').innerText + '\n\n';
            
            relatorio += `**CONDUTA**\n`;
            relatorio += document.getElementById('condutaGerada').innerText;
            
            const relatorioDiv = document.getElementById('relatorioCompleto');
            relatorioDiv.style.display = 'block';
            document.getElementById('conteudoRelatorio').innerHTML = relatorio.replace(/\n/g, '<br>');
        }

        function copiarTexto() {
            const relatorioDiv = document.getElementById('relatorioCompleto');
            if (relatorioDiv.style.display === 'none') {
                alert('Gere o relat√≥rio completo primeiro!');
                return;
            }
            
            const texto = document.getElementById('conteudoRelatorio').innerText;
            navigator.clipboard.writeText(texto).then(() => {
                alert('Relat√≥rio copiado para a √°rea de transfer√™ncia!');
            }).catch(() => {
                alert('Erro ao copiar texto. Selecione e copie manualmente.');
            });
        }

        function limparFormulario() {
            if (confirm('Tem certeza que deseja limpar todos os dados?')) {
                location.reload();
            }
        }

        // Adicionar primeiro medicamento ao carregar
        window.onload = function() {
            adicionarMedicamento();
            gerarHDeConduta();
        };
    </script>
</body>
</html>
