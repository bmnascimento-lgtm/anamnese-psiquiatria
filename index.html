<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìã Avalia√ß√£o Psiqui√°trica ¬∑ CAPS / Ambulat√≥rio</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background: #e9f0f5;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
            padding: 1.5rem;
            color: #1e2b3a;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        h1 { font-size: 2.2rem; font-weight: 400; border-bottom: 3px solid #2c6e9c; padding-bottom: 0.3rem; margin-bottom: 0.5rem; color: #0b3b5a; }
        h2 { font-size: 1.5rem; margin: 0.8rem 0 0.2rem; color: #14471c; border-left: 5px solid #3f8ab3; padding-left: 0.7rem; background: #f4f9ff; line-height: 1.3; }
        h3 { font-size: 1.2rem; margin: 1rem 0 0.3rem; color: #1d4e6f; }
        .card {
            background: white;
            border-radius: 24px;
            padding: 1.8rem 2rem;
            box-shadow: 0 15px 30px rgba(0,30,50,0.15);
            border: 1px solid rgba(60,130,190,0.2);
        }
        .flex-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: flex-end;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            min-width: 100px;
        }
        .input-group label {
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #2a5f7a;
        }
        .input-group input, .input-group select {
            padding: 0.6rem 1rem;
            border: 1px solid #bdd3e6;
            border-radius: 40px;
            font-size: 1rem;
            background: #fafdff;
            transition: 0.2s;
        }
        .input-group input:focus, .input-group select:focus {
            border-color: #1f7faa;
            outline: none;
            box-shadow: 0 0 0 3px rgba(31,127,170,0.2);
        }
        .inline-label {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .inline-label span {
            font-weight: 600;
            background: #e1effa;
            padding: 0.3rem 1.2rem;
            border-radius: 40px;
        }
        .btn {
            background: #1d7aa3;
            border: none;
            color: white;
            font-weight: 600;
            padding: 0.8rem 2rem;
            border-radius: 60px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 8px rgba(0,60,100,0.2);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .btn:hover {
            background: #0e5e85;
            transform: translateY(-2px);
            box-shadow: 0 8px 14px rgba(0,40,70,0.3);
        }
        .btn-secondary {
            background: #3f7890;
        }
        .btn-copy {
            background: #2d6d4b;
            float: right;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.2rem 0;
            background: #f1f9fd;
            border-radius: 20px;
            overflow: hidden;
        }
        th, td {
            padding: 0.9rem 1rem;
            text-align: left;
            border-bottom: 1px solid #cbdae6;
        }
        th {
            background: #c3dff5;
            font-weight: 700;
            color: #0a3144;
        }
        .meem-section {
            background: #e9f2fa;
            padding: 1.2rem 1.5rem;
            border-radius: 28px;
            margin: 1.5rem 0;
        }
        .meem-item {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
            margin: 0.8rem 0;
        }
        .meem-item label {
            min-width: 170px;
            font-weight: 600;
        }
        .radio-group {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }
        .radio-group input {
            margin-right: 0.2rem;
        }
        .output-box {
            background: #0e262e;
            color: #d9f0fa;
            padding: 1.5rem 2rem;
            border-radius: 32px;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            white-space: pre-wrap;
            border: 1px solid #2f7d9c;
            box-shadow: inset 0 0 10px #00000030;
            max-height: 400px;
            overflow-y: auto;
        }
        .generated-hda {
            background: #10313c;
        }
        .footer-notes {
            font-size: 0.8rem;
            color: #2b5f7a;
            margin-top: 1rem;
            border-top: 1px dashed #9bbad0;
            padding-top: 1rem;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>üß† EXAME PS√çQUICO INTEGRADO ¬∑ CAPS</h1>

    <!-- PRIMEIRA PARTE: sexo, idade, peso, altura, IMC -->
    <div class="card">
        <h2>üìå Dados sociodemogr√°ficos e IMC</h2>
        <div class="flex-row">
            <div class="input-group">
                <label>Sexo</label>
                <select id="sexo">
                    <option value="feminino">Feminino</option>
                    <option value="masculino">Masculino</option>
                    <option value="outro">Outro / n√£o bin√°rio</option>
                </select>
            </div>
            <div class="input-group">
                <label>Idade (anos)</label>
                <input type="number" id="idade" min="0" max="120" value="35">
            </div>
            <div class="input-group">
                <label>Peso (kg)</label>
                <input type="number" id="peso" step="0.1" min="20" max="250" value="70.5">
            </div>
            <div class="input-group">
                <label>Altura (m)</label>
                <input type="number" id="altura" step="0.01" min="1.0" max="2.5" value="1.70">
            </div>
            <div class="input-group">
                <label>IMC calculado</label>
                <input type="text" id="imc" readonly value="24.4">
            </div>
            <div class="input-group">
                <label>Classifica√ß√£o</label>
                <input type="text" id="classIMC" readonly value="Peso normal">
            </div>
        </div>
        <div style="margin-top:0.8rem">
            <button class="btn" id="calcIMC">üìê Calcular IMC e classificar</button>
        </div>
    </div>

    <!-- MINI EXAME DO ESTADO MENTAL (MEEM) completo -->
    <div class="card meem-section">
        <h2>üß© Mini-Exame do Estado Mental (MEEM) ¬∑ pontua√ß√£o: <span id="meemTotal">0</span>/30</h2>
        <table>
            <tr><th>Item</th><th>Pontua√ß√£o (selecionar)</th></tr>
            <tr><td>Orienta√ß√£o temporal (ano, esta√ß, dia, m√™s) 0-5</td><td><select class="meem" id="meem1">${[0,1,2,3,4,5].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Orienta√ß√£o espacial (pa√≠s, estado, cidade, local, andar) 0-5</td><td><select class="meem" id="meem2">${[0,1,2,3,4,5].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Registro (pente, rua, azul) 0-3</td><td><select class="meem" id="meem3">${[0,1,2,3].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Aten√ß√£o/c√°lculo (100-7 ou s√©rie) 0-5</td><td><select class="meem" id="meem4">${[0,1,2,3,4,5].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Evoca√ß√£o (3 palavras) 0-3</td><td><select class="meem" id="meem5">${[0,1,2,3].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Linguagem: nomear l√°pis/rel√≥gio (0-2)</td><td><select class="meem" id="meem6">${[0,1,2].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Repetir "nem aqui, nem ali, nem l√°" (0-1)</td><td><select class="meem" id="meem7"><option value="0">0</option><option value="1" selected>1</option></select></td></tr>
            <tr><td>Comando tr√™s est√°gios (pegar/dobrar/colocar) 0-3</td><td><select class="meem" id="meem8">${[0,1,2,3].map(i=>`<option value="${i}">${i}</option>`)}</select></td></tr>
            <tr><td>Ler e executar "FECHE OS OLHOS" (0-1)</td><td><select class="meem" id="meem9"><option value="0">0</option><option value="1">1</option></select></td></tr>
            <tr><td>Escrever uma frase (0-1)</td><td><select class="meem" id="meem10"><option value="0">0</option><option value="1">1</option></select></td></tr>
            <tr><td>Copiar desenho (0-1)</td><td><select class="meem" id="meem11"><option value="0">0</option><option value="1">1</option></select></td></tr>
        </table>
        <div style="display:flex; gap:1rem; align-items:center;">
            <span style="font-weight:700;">Escore MEEM: <span id="meemValor">30</span>/30</span>
            <span>üìå (ajuste conforme exame real)</span>
        </div>
    </div>

    <!-- SELE√á√ÉO DE FUN√á√ïES PS√çQUICAS (baseado nos PDFs) -->
    <div class="card">
        <h2>üß† EXAME PS√çQUICO (selecionar achados predominantes)</h2>
        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(320px,1fr)); gap: 1.5rem;">
            <!-- consci√™ncia -->
            <div><label>üß† Consci√™ncia:</label> <select id="consciencia"><option value="l√∫cido">l√∫cido</option><option value="obnubilado">obnubilado</option><option value="sonolento">sonolento</option><option value="torporoso">torporoso</option><option value="estado crepuscular">estado crepuscular</option><option value="delirium">delirium</option></select></div>
            <!-- aten√ß√£o -->
            <div><label>üéØ Aten√ß√£o:</label> <select id="atencao"><option value="normoprosexia (eut√™naz)">normoprosexia</option><option value="hipoprosexia">hipoprosexia</option><option value="hiperprosexia">hiperprosexia</option><option value="distra√ß√£o (hipertenaz/hipovigil)">distra√ß√£o</option><option value="disprosexia">disprosexia</option></select></div>
            <!-- orienta√ß√£o -->
            <div><label>üß≠ Orienta√ß√£o:</label> <select id="orientacao"><option value="orientado auto e alopsiquicamente">orientado auto/alopsiquicamente</option><option value="desorientado temporal">desorientado temporal</option><option value="desorientado espacial">desorientado espacial</option><option value="desorienta√ß√£o amn√©sica">desorienta√ß√£o amn√©sica</option></select></div>
            <!-- mem√≥ria -->
            <div><label>üíæ Mem√≥ria:</label> <select id="memoria"><option value="preservada">preservada</option><option value="hipomn√©sia anter√≥grada">hipomn√©sia anter√≥grada</option><option value="amn√©sia retr√≥grada">amn√©sia retr√≥grada</option><option value="confabula√ß√£o">confabula√ß√£o</option><option value="hipermn√©sia">hipermn√©sia</option></select></div>
            <!-- intelig√™ncia -->
            <div><label>üìö Intelig√™ncia:</label> <select id="inteligencia"><option value="dentro da m√©dia esperada">dentro da m√©dia</option><option value="inferior √† m√©dia (leve)">inferior (leve)</option><option value="deficit moderado">d√©ficit moderado</option><option value="superior √† m√©dia">superior</option></select></div>
            <!-- sensopercep√ß√£o -->
            <div><label>üëÅÔ∏è Sensopercep√ß√£o:</label> <select id="sensopercepcao"><option value="sem altera√ß√µes">sem altera√ß√µes</option><option value="alucina√ß√£o auditiva">alucina√ß√£o auditiva</option><option value="alucina√ß√£o visual">alucina√ß√£o visual</option><option value="ilus√£o">ilus√£o</option><option value="alucina√ß√£o cenest√©sica">cenest√©sica</option><option value="desrealiza√ß√£o">desrealiza√ß√£o</option></select></div>
            <!-- afeto/humor -->
            <div><label>üòê Afeto/humor:</label> <select id="afeto"><option value="eut√≠mico">eut√≠mico</option><option value="depressivo">depressivo</option><option value="ansioso">ansioso</option><option value="euf√≥rico (hipert√≠mico)">euf√≥rico</option><option value="embotado">embotado</option><option value="irrit√°vel">irrit√°vel</option><option value="labilidade afetiva">labilidade</option></select></div>
            <!-- pensamento (curso) -->
            <div><label>‚ö° Pensamento (curso):</label> <select id="pensamentoCurso"><option value="regular, sem acelera√ß√£o">regular</option><option value="acelerado (taquipsiquismo)">acelerado</option><option value="lentificado (bradipsiquismo)">lentificado</option><option value="fuga de id√©ias">fuga de id√©ias</option><option value="bloqueio">bloqueio</option><option value="prolixidade">prolixidade</option></select></div>
            <!-- conte√∫do do pensamento -->
            <div><label>üí≠ Conte√∫do:</label> <select id="conteudo"><option value="sem idea√ß√£o delirante">sem delirios</option><option value="del√≠rio persecut√≥rio">persecut√≥rio</option><option value="del√≠rio de grandeza">grandeza</option><option value="del√≠rio de refer√™ncia">refer√™ncia</option><option value="idea√ß√£o suicida">idea√ß√£o suicida</option><option value="obsess√µes">obsess√µes</option><option value="hipocondr√≠aco">hipocondr√≠aco</option></select></div>
            <!-- linguagem -->
            <div><label>üó£Ô∏è Linguagem:</label> <select id="linguagem"><option value="fluente, articulada">fluente</option><option value="logorreia">logorreia</option><option value="mutismo">mutismo</option><option value="ecolalia">ecolalia</option><option value="neologismos">neologismos</option><option value="bradilalia">bradilalia</option></select></div>
            <!-- psicomotricidade/conduta -->
            <div><label>üèÉ Psicomotricidade:</label> <select id="psicomotricidade"><option value="normal">normal</option><option value="agitado (hiperatividade)">agitado</option><option value="lentificado (hipoatividade)">lentificado</option><option value="maneirismos/estereotipias">estereotipias</option><option value="flexibilidade c√©rea">flexibilidade c√©rea</option></select></div>
            <!-- vontade -->
            <div><label>‚öñÔ∏è Vontade:</label> <select id="vontade"><option value="normobulia">normobulia</option><option value="hipobulia">hipobulia</option><option value="abulia">abulia</option><option value="hiperbulia">hiperbulia</option></select></div>
            <!-- ju√≠zo cr√≠tico -->
            <div><label>üîé Ju√≠zo cr√≠tico:</label> <select id="juizo"><option value="preservado">preservado</option><option value="parcialmente preservado">parcialmente preservado</option><option value="prejudicado (insight ausente)">prejudicado</option></select></div>
        </div>
    </div>

    <!-- Bot√µes: gerar HDA + conduta autom√°tica + c√≥pia -->
    <div style="display: flex; gap: 1.5rem; flex-wrap: wrap; align-items: center;">
        <button class="btn" id="gerarHDA">üìÑ GERAR HDA e CONDUTA autom√°ticos</button>
        <button class="btn btn-secondary" id="copiarTexto">üìã COPIAR EVOLU√á√ÉO</button>
        <span style="color:#1d5a7a;">* a HDA ser√° constru√≠da com base nas sele√ß√µes</span>
    </div>

    <!-- OUTPUT FINAL (HDA + exame + conduta) -->
    <div class="output-box" id="outputFinal">
        Clique em "GERAR HDA" para criar o texto estruturado.
    </div>

    <!-- observa√ß√µes e refer√™ncia r√°pida -->
    <div class="footer-notes">
        ‚ö° Baseado em: MEEM (anexo), Psicopatologia (Maristela Sousa), modelo Anchyses Jobim, CASOMI APEJUCOL. <br>
        Classifica√ß√£o IMC (OMS) ¬∑ conduta gerada conforme pontua√ß√£o MEEM e gravidade psicopatol√≥gica.
    </div>
</div>

<script>
    (function() {
        // helpers
        const imcCalc = () => {
            const peso = parseFloat(document.getElementById('peso').value) || 0;
            const altura = parseFloat(document.getElementById('altura').value) || 1;
            if (peso <= 0 || altura <= 0.5) return { imc: 0, class: 'Inv√°lido' };
            const imc = peso / (altura * altura);
            let classe = '';
            if (imc < 18.5) classe = 'Abaixo do peso';
            else if (imc < 25) classe = 'Peso normal';
            else if (imc < 30) classe = 'Sobrepeso';
            else if (imc < 35) classe = 'Obesidade grau I';
            else if (imc < 40) classe = 'Obesidade grau II';
            else classe = 'Obesidade grau III';
            return { imc: imc.toFixed(1), class: classe };
        };

        const atualizarIMC = () => {
            const res = imcCalc();
            document.getElementById('imc').value = res.imc;
            document.getElementById('classIMC').value = res.class;
        };
        document.getElementById('calcIMC').addEventListener('click', atualizarIMC);
        atualizarIMC(); // inicial

        // MEEM total
        const meemSelects = document.querySelectorAll('.meem');
        function calcMEEM() {
            let total = 0;
            meemSelects.forEach(sel => { total += parseInt(sel.value || 0); });
            document.getElementById('meemValor').innerText = total;
            document.getElementById('meemTotal').innerText = total;
            return total;
        }
        meemSelects.forEach(s => s.addEventListener('change', calcMEEM));
        calcMEEM();

        // principal gerador HDA + conduta
        document.getElementById('gerarHDA').addEventListener('click', function() {
            const sexo = document.getElementById('sexo').value;
            const idade = document.getElementById('idade').value;
            const imc = document.getElementById('imc').value;
            const classeImc = document.getElementById('classIMC').value;

            // mneum√¥nico CASOMI + APEJUCOL (extra√≠do dos selects)
            const consc = document.getElementById('consciencia').value;
            const atenc = document.getElementById('atencao').value;
            const orient = document.getElementById('orientacao').value;
            const mem = document.getElementById('memoria').value;
            const intel = document.getElementById('inteligencia').value;
            const sens = document.getElementById('sensopercepcao').value;

            const afet = document.getElementById('afeto').value;
            const pensCurso = document.getElementById('pensamentoCurso').value;
            const conteudoPens = document.getElementById('conteudo').value;
            // ju√≠zo
            const juizo = document.getElementById('juizo').value;
            // conduta psicomotricidade
            const psicomot = document.getElementById('psicomotricidade').value;
            const vont = document.getElementById('vontade').value;
            const ling = document.getElementById('linguagem').value;
            const meemTotal = parseInt(document.getElementById('meemValor').innerText);

            // constru√ß√£o da HDA (frases autom√°ticas baseadas nas escolhas)
            let hda = `HIST√ìRIA DA DOEN√áA ATUAL (gerada automaticamente):\n`;
            hda += `Paciente ${sexo}, ${idade} anos, IMC=${imc} (${classeImc}).\n`;
            hda += `Queixa principal referida conforme avaliado. O quadro evoluiu com `;

            // sintomas baseado em sensopercep√ß√£o/psicomotricidade/afeto
            if (sens.includes('alucina√ß√£o')) hda += `relato de ${sens}, `;
            if (conteudoPens.includes('del√≠rio') || conteudoPens.includes('persecut') || conteudoPens.includes('grandeza')) hda += `idea√ß√£o ${conteudoPens}, `;
            if (afet.includes('depress')) hda += `humor depressivo, `;
            if (afet.includes('euf√≥rico') || afet.includes('hipert√≠mico')) hda += `humor exaltado, `;
            if (pensCurso.includes('acelerado') || pensCurso.includes('fuga')) hda += `pensamento acelerado (${pensCurso}), `;
            if (pensCurso.includes('lentif')) hda += `lentifica√ß√£o ps√≠quica, `;
            if (psicomot.includes('agitado')) hda += `agita√ß√£o psicomotora, `;
            if (psicomot.includes('lentificado')) hda += `hipoatividade motora, `;
            if (mem.includes('hipomn√©sia') || mem.includes('amn√©sia')) hda += `com evid√™ncias de ${mem}, `;
            if (ling.includes('logor')) hda += `logorreia, `;
            if (ling.includes('mutismo')) hda += `mutismo, `;
            hda = hda.replace(/, $/, '') + '.\n';

            hda += `Apresenta MEEM=${meemTotal}/30. `;
            if (meemTotal < 24) hda += `(pontua√ß√£o sugestiva de decl√≠nio cognitivo). `;
            else hda += `(sem altera√ß√µes cognitivas significativas). `;

            // EXAME PS√çQUICO detalhado
            let exame = `\nEXAME PS√çQUICO (observa√ß√£o):\n`;
            exame += `‚ñ∂ Consci√™ncia: ${consc}. | Aten√ß√£o: ${atenc}. | Orienta√ß√£o: ${orient}.\n`;
            exame += `‚ñ∂ Mem√≥ria: ${mem}. | Intelig√™ncia: ${intel}. | Sensopercep√ß√£o: ${sens}.\n`;
            exame += `‚ñ∂ Afeto/humor: ${afet}. | Pensamento (curso): ${pensCurso}. | Conte√∫do: ${conteudoPens}.\n`;
            exame += `‚ñ∂ Linguagem: ${ling}. | Psicomotricidade: ${psicomot}. | Vontade: ${vont}. | Ju√≠zo cr√≠tico: ${juizo}.\n`;

            // CONDUTA autom√°tica baseada em gravidade
            let conduta = `\nCONDUTA / PLANO TERAP√äUTICO (autom√°tica):\n`;
            if (conteudoPens.includes('suicida') || conteudoPens.includes('homicida')) conduta += 'üö® Risco de auto/heteroagress√£o. Encaminhamento para avalia√ß√£o de risco imediato. ';
            if (sens.includes('alucina√ß√£o') && !juizo.includes('preservado')) conduta += 'Sintomas psic√≥ticos ativos. Considerar ajuste de antipsic√≥tico. ';
            if (afet.includes('depress') && meemTotal < 28) conduta += 'Hipotimia significativa. Avaliar introdu√ß√£o/otimiza√ß√£o de antidepressivo + suporte psicol√≥gico. ';
            if (afet.includes('euf√≥rico') || pensCurso.includes('acelerado')) conduta += 'Quadro compat√≠vel com ativa√ß√£o maniforme. Estabilizador de humor / neurol√©ptico. ';
            if (mem.includes('hipomn√©sia') || mem.includes('amn√©sia') || meemTotal < 24) conduta += 'Necess√°rio investigar causa de decl√≠nio cognitivo: exames de imagem, laborat√≥rio. ';
            if (psicomot.includes('estereo') || psicomot.includes('flexibilidade')) conduta += 'Sinais catat√¥nicos. Avaliar escala de catatonia. ';
            conduta += '\n‚ñ∂ Conduta geral: acolhimento, psicoeduca√ß√£o, agendar retorno em 2 semanas. Notificar equipe multiprofissional.';

            if (conduta.length < 80) conduta += '\n‚ñ∂ Manter suporte, reavaliar em consulta.';

            const textoFinal = hda + exame + conduta;
            document.getElementById('outputFinal').innerText = textoFinal;
        });

        // copiar
        document.getElementById('copiarTexto').addEventListener('click', function() {
            const texto = document.getElementById('outputFinal').innerText;
            navigator.clipboard.writeText(texto).then(() => {
                alert('‚úÖ Texto copiado para a √°rea de transfer√™ncia!');
            }).catch(() => alert('‚ùå Erro ao copiar, selecione manualmente.'));
        });

        // sincronizar MEEM ao iniciar
        calcMEEM();
    })();
</script>
</body>
      </html>
